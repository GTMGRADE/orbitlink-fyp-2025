<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Project SNA - OrbitLink</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: Arial, sans-serif;
        background-color: #1E3167; /* Same blue as dashboard/landing */
        color: white;
        min-height: 100vh;
      }

      /* Unified Layout - Matching Dashboard */
      .layout {
        display: grid;
        grid-template-columns: 240px 1fr;
        min-height: 100vh;
      }

      /* Sidebar - More Compact (Matching Dashboard) */
      .sidebar {
        background: #F24822; /* Same orange */
        padding: 1.2rem 0.8rem;
        display: flex;
        flex-direction: column;
        gap: 1.2rem;
        position: relative;
      }

      /* Brand - More Compact, Aligned with Dashboard */
      .brand-section {
        display: flex;
        align-items: center;
        padding: 0.5rem 0.8rem;
        margin-bottom: 0.2rem;
      }

      .brand {
        font-size: 1.9rem;
        font-weight: bold;
        color: black;
        line-height: 1;
      }

      /* Create Button - More Compact (Matching Dashboard) */
      .create-btn {
        background: #14294a;
        color: white;
        border-radius: 10px;
        padding: 0.9rem 0.8rem;
        text-align: center;
        font-weight: 700;
        font-size: 1rem;
        text-decoration: none;
        transition: all 0.2s;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .create-btn:hover {
        background: #0f1c3d;
        transform: translateY(-1px);
      }

      /* Menu - Moved Higher (Matching Dashboard) */
      .menu {
        display: flex;
        flex-direction: column;
        gap: 0.6rem;
        margin-top: 0.3rem;
      }

      .menu a {
        display: block;
        padding: 0.75rem 0.8rem;
        background: rgba(255, 255, 255, 0.1);
        color: white;
        text-decoration: none;
        border-radius: 8px;
        font-weight: 600;
        transition: all 0.2s;
        border: 1px solid rgba(255, 255, 255, 0.05);
        font-size: 0.9rem;
      }

      .menu a.active {
        background: rgba(255, 255, 255, 0.22);
        border-color: rgba(255, 255, 255, 0.15);
      }

      .menu a:hover {
        background: rgba(255, 255, 255, 0.15);
        transform: translateX(3px);
      }

      /* Main Content Area - Matching Dashboard Blue */
      .content {
        background: #1E3167;
        padding: 1.5rem 2rem;
      }

      /* Header - More Compact, Better Alignment (Matching Dashboard) */
      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.2rem;
        padding-bottom: 0.8rem;
        border-bottom: 2px solid rgba(255, 255, 255, 0.1);
      }

      .title {
        font-size: 1.8rem;
        font-weight: 700;
        color: white;
        letter-spacing: 0.3px;
        line-height: 1;
        padding-top: 0.2rem;
      }

      .profile-btn {
        text-decoration: none;
        color: black;
        font-weight: 700;
        padding: 0.7rem 1.5rem;
        background: #ff3333;
        border-radius: 6px;
        transition: all 0.2s;
        font-size: 0.95rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
        line-height: 1;
        height: fit-content;
        margin-top: 0.2rem;
      }

      .profile-btn:hover {
        background: #cc0000;
        color: white;
        transform: translateY(-2px);
      }

      .profile-btn:active {
        transform: translateY(0);
      }

      /* Main Container - Matching Dashboard Style */
      .container {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        padding: 2rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
        max-width: 1200px;
        margin: 0 auto;
      }
      
      /* URL Input Section - Cleaner Design */
      .url-input-section {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        padding: 2rem;
        margin-bottom: 2.5rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      
      .input-header {
        text-align: center;
        margin-bottom: 1.5rem;
      }
      
      .input-header h3 {
        font-size: 1.4rem;
        color: white;
        margin-bottom: 0.8rem;
        font-weight: 700;
      }
      
      .input-header p {
        color: rgba(255, 255, 255, 0.8);
        font-size: 1rem;
        line-height: 1.5;
        max-width: 600px;
        margin: 0 auto;
      }
      
      .input-group {
        display: flex;
        gap: 1rem;
        margin-bottom: 1.5rem;
        margin-top: 1.5rem;
      }
      
      .url-input {
        flex: 1;
        padding: 1rem 1.2rem;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 8px;
        color: white;
        font-size: 1rem;
        transition: all 0.3s;
      }
      
      .url-input:focus {
        outline: none;
        border-color: #ff3333;
        background: rgba(255, 255, 255, 0.15);
        box-shadow: 0 0 0 2px rgba(255, 51, 51, 0.2);
      }
      
      .url-input::placeholder {
        color: rgba(255, 255, 255, 0.5);
      }
      
      .confirm-btn {
        padding: 1rem 2rem;
        background: #ff3333;
        color: white;
        border: none;
        border-radius: 8px;
        font-weight: 700;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s;
        white-space: nowrap;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      
      .confirm-btn:hover {
        background: #cc0000;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      }
      
      .confirm-btn.confirmed {
        background: #27ca3f;
      }
      
      .confirm-btn.confirmed:hover {
        background: #1fa832;
        box-shadow: 0 4px 8px rgba(39, 202, 63, 0.3);
      }
      
      /* Status Message */
      .status-message {
        padding: 1rem;
        border-radius: 8px;
        text-align: center;
        font-weight: 600;
        display: none;
        margin-top: 1rem;
        animation: fadeIn 0.3s ease;
      }
      
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      
      .status-success {
        background: rgba(39, 202, 63, 0.2);
        border: 1px solid #27ca3f;
        color: #27ca3f;
      }
      
      .status-error {
        background: rgba(255, 51, 51, 0.2);
        border: 1px solid #ff3333;
        color: #ff3333;
      }
      
      /* Data Source Tabs */
      .data-source-tabs {
        display: flex;
        gap: 1rem;
        margin-top: 1.5rem;
        flex-wrap: wrap;
        justify-content: center;
      }
      
      .tab-btn {
        padding: 0.8rem 1.5rem;
        background: rgba(255, 255, 255, 0.08);
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 20px;
        color: white;
        cursor: pointer;
        font-size: 0.9rem;
        transition: all 0.3s;
      }
      
      .tab-btn:hover {
        background: rgba(255, 255, 255, 0.12);
        transform: translateY(-2px);
      }
      
      .tab-btn.active {
        background: rgba(255, 51, 51, 0.2);
        border-color: #ff3333;
        color: #ff3333;
      }
      
      /* Analysis Section */
      .analysis-section {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        padding: 2rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      
      .section-title {
        text-align: center;
        font-size: 1.4rem;
        font-weight: 700;
        margin-bottom: 2rem;
        color: white;
        padding-bottom: 1rem;
        border-bottom: 2px solid rgba(255, 255, 255, 0.1);
      }
      
      .analysis-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
      }
      
      .analysis-card {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        padding: 1.8rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: all 0.3s ease;
        text-align: center;
      }
      
      .analysis-card:hover {
        background: rgba(255, 255, 255, 0.08);
        transform: translateY(-5px);
        border-color: rgba(255, 255, 255, 0.2);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      }
      
      .analysis-card.disabled {
        opacity: 0.5;
        cursor: not-allowed;
        pointer-events: none;
      }
      
      .analysis-name {
        font-size: 1.2rem;
        font-weight: 700;
        color: white;
        margin-bottom: 0.8rem;
      }
      
      .analysis-desc {
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.7);
        line-height: 1.5;
        margin-bottom: 1.5rem;
      }
      
      .analysis-link {
        display: inline-block;
        padding: 0.8rem 1.5rem;
        background: #ff3333;
        color: white;
        text-decoration: none;
        border-radius: 6px;
        font-weight: 600;
        font-size: 0.9rem;
        transition: all 0.3s;
        border: none;
        cursor: pointer;
        width: 100%;
        text-align: center;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      
      .analysis-link:hover {
        background: #cc0000;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      }
      
      .analysis-link.disabled {
        background: #666;
        cursor: not-allowed;
      }
      
      .analysis-link.disabled:hover {
        transform: none;
        background: #666;
        box-shadow: none;
      }
      
      /* Responsive Design - Matching Dashboard */
      @media (max-width: 1024px) {
        .layout {
          grid-template-columns: 220px 1fr;
        }
        
        .content {
          padding: 1.2rem 1.5rem;
        }
        
        .title {
          font-size: 1.6rem;
        }
        
        .brand {
          font-size: 1.7rem;
        }
      }

      @media (max-width: 768px) {
        .layout {
          grid-template-columns: 1fr;
        }

        .sidebar {
          flex-direction: row;
          align-items: center;
          padding: 0.8rem 1rem;
          gap: 1rem;
        }

        .brand-section {
          margin-bottom: 0;
          padding: 0.3rem 0.5rem;
        }

        .brand {
          font-size: 1.7rem;
        }

        .create-btn {
          padding: 0.7rem 0.8rem;
          font-size: 0.9rem;
        }

        .menu {
          display: none;
        }

        .content {
          padding: 1rem 1.2rem;
        }

        .header {
          flex-direction: column;
          gap: 0.8rem;
          align-items: flex-start;
          margin-bottom: 1.2rem;
          padding-bottom: 0.8rem;
        }

        .title {
          font-size: 1.5rem;
          padding-top: 0;
        }

        .profile-btn {
          align-self: flex-start;
          padding: 0.6rem 1.2rem;
          font-size: 0.9rem;
          margin-top: 0;
        }

        .analysis-grid {
          grid-template-columns: 1fr;
        }

        .container {
          padding: 1.5rem;
        }

        .input-group {
          flex-direction: column;
        }

        .confirm-btn {
          width: 100%;
        }

        .data-source-tabs {
          flex-direction: column;
        }

        .tab-btn {
          width: 100%;
          text-align: center;
        }
      }

      @media (max-width: 480px) {
        .content {
          padding: 0.8rem 1rem;
        }

        .title {
          font-size: 1.4rem;
        }

        .profile-btn {
          padding: 0.5rem 1rem;
          font-size: 0.85rem;
        }
        
        .container {
          padding: 1.2rem;
        }
        
        .url-input-section,
        .analysis-section {
          padding: 1.5rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="layout">
      <aside class="sidebar">
        <div class="brand-section">
          <div class="brand">OrbitLink</div>
        </div>
        <a href="{{ url_for('projects.projects_create_get') }}" class="create-btn">Create +</a>
        <nav class="menu">
          <a href="{{ url_for('projects.dashboard') }}">Dashboard</a>
          <a href="{{ url_for('projects.projects_list') }}">Projects</a>
          <a href="{{ url_for('projects.project_sna') }}" class="active">Analysis</a>
          <a href="#">Support</a>
          <a href="#">Setting</a>
        </nav>
      </aside>

      <main class="content">
        <!-- Header - Now properly aligned with OrbitLink logo -->
        <div class="header">
          <div class="title">Project Analysis</div>
          <a href="{{ url_for('user.profile') }}" class="profile-btn">Profile</a>
        </div>

        <div class="container">
          <!-- Data Input Section -->
          <div class="url-input-section">
            <div class="input-header">
              <h3>Enter Data Source</h3>
              <p>Paste the URL of the YouTube channel you want to analyze</p>
            </div>
            
            <div class="input-group">
              <input 
                type="url" 
                id="youtubeUrl" 
                class="url-input" 
                placeholder="https://www.youtube.com/@ChannelName or https://www.youtube.com/c/ChannelName"
                value=""
              />
              <button type="button" class="confirm-btn" id="confirmBtn">Confirm</button>
            </div>
            
            <!-- Data source tabs -->
            <div class="data-source-tabs">
              <button class="tab-btn active" data-source="youtube">YouTube</button>
              <button class="tab-btn" data-source="csv">CSV Upload</button>
            </div>
            
            <div id="statusMessage" class="status-message"></div>
          </div>

          <!-- Analysis Options Section -->
          <div class="analysis-section">
            <h2 class="section-title">Select Analysis Type</h2>
            <div class="analysis-grid">
              <!-- Sentiment Analysis Card -->
              <div class="analysis-card" id="sentimentCard">
                <h3 class="analysis-name">Sentiment Analysis</h3>
                <p class="analysis-desc">Analyze opinions and track sentiment shifts over time to understand public perception</p>
                <a href="{{ url_for('projects.sentiment_analysis') }}" class="analysis-link disabled" id="sentimentLink">Open Analysis</a>
              </div>

              <!-- Data Monitoring Card -->
              <div class="analysis-card" id="monitoringCard">
                <h3 class="analysis-name">Data Monitoring</h3>
                <p class="analysis-desc">Track follower dynamics, post performance, and engagement metrics in real-time</p>
                <a href="{{ url_for('projects.data_monitoring') }}" class="analysis-link disabled" id="monitoringLink">Open Analysis</a>
              </div>

              <!-- Historical Analysis Card -->
              <div class="analysis-card" id="historicalCard">
                <h3 class="analysis-name">Historical Analysis</h3>
                <p class="analysis-desc">Analyze long-term trends, follower growth, and historical campaign performance</p>
                <a href="{{ url_for('projects.historical_analysis') }}" class="analysis-link disabled" id="historicalLink">Open Analysis</a>
              </div>

              {% if session.get('user_type') == 'business' %}
              <!-- Influencer Detection Card -->
              <div class="analysis-card" id="influencersCard">
                <h3 class="analysis-name">Identify Influencers</h3>
                <p class="analysis-desc">Identify key influencers and high-impact accounts driving conversations</p>
                <a href="{{ url_for('projects.identify_influencers') }}" class="analysis-link disabled" id="influencersLink">Open Analysis</a>
              </div>

              <!-- Community Detection Card -->
              <div class="analysis-card" id="communitiesCard">
                <h3 class="analysis-name">Detect Communities</h3>
                <p class="analysis-desc">Detect subgroups and analyze information flows between different community segments</p>
                <a href="{{ url_for('projects.detect_communities') }}" class="analysis-link disabled" id="communitiesLink">Open Analysis</a>
              </div>
              {% endif %}
            </div>
          </div>
        </div>
      </main>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const urlInput = document.getElementById('youtubeUrl');
        const confirmBtn = document.getElementById('confirmBtn');
        const statusMessage = document.getElementById('statusMessage');
        const tabBtns = document.querySelectorAll('.tab-btn');
        const analysisLinks = document.querySelectorAll('.analysis-link');
        const analysisCards = document.querySelectorAll('.analysis-card');
        
        // Tab selection
        tabBtns.forEach(btn => {
          btn.addEventListener('click', function() {
            tabBtns.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            const source = this.dataset.source;
            updatePlaceholder(source);
          });
        });
        
        function updatePlaceholder(source) {
          switch(source) {
            case 'youtube':
              urlInput.placeholder = 'https://www.youtube.com/@ChannelName or https://www.youtube.com/c/ChannelName';
              break;
            case 'csv':
              urlInput.placeholder = 'Drag and drop CSV file or paste file path';
              break;
          }
        }
        
        // URL validation and confirmation
        confirmBtn.addEventListener('click', function() {
          const url = urlInput.value.trim();
          const activeTab = document.querySelector('.tab-btn.active').dataset.source;
          
          if (!url) {
            showStatus('Please enter a valid URL or file path', 'error');
            urlInput.focus();
            return;
          }
          
          // Validate YouTube URL if YouTube tab is selected
          if (activeTab === 'youtube' && !isValidYouTubeUrl(url)) {
            showStatus('Please enter a valid YouTube channel URL', 'error');
            return;
          }
          
          // Show loading state
          confirmBtn.textContent = 'Processing...';
          confirmBtn.disabled = true;
          
          // Simulate API call/processing
          setTimeout(() => {
            // Enable all analysis cards
            analysisCards.forEach(card => {
              card.classList.remove('disabled');
            });
            
            analysisLinks.forEach(link => {
              link.classList.remove('disabled');
            });
            
            showStatus('âœ“ Success! Data has been loaded. You can now open any analysis.', 'success');
            
            // Update button state
            confirmBtn.textContent = 'Confirmed';
            confirmBtn.classList.add('confirmed');
            confirmBtn.disabled = false;
            
            // Store the URL in session or send to server
            console.log(`Processing ${activeTab} data from:`, url);
            
          }, 1500);
        });
        
        function isValidYouTubeUrl(url) {
          // Basic YouTube URL validation
          const youtubePatterns = [
            /^(https?:\/\/)?(www\.)?youtube\.com\/(c\/|channel\/|@)/,
            /^(https?:\/\/)?(www\.)?youtu\.be\//,
            /^(https?:\/\/)?(www\.)?youtube\.com\/user\//
          ];
          
          return youtubePatterns.some(pattern => pattern.test(url));
        }
        
        function showStatus(message, type) {
          statusMessage.textContent = message;
          statusMessage.className = 'status-message';
          statusMessage.classList.add(`status-${type}`);
          statusMessage.style.display = 'block';
          
          // Auto-hide success messages after 5 seconds
          if (type === 'success') {
            setTimeout(() => {
              statusMessage.style.display = 'none';
            }, 5000);
          }
        }
        
        // Clear status when user starts typing
        urlInput.addEventListener('input', function() {
          statusMessage.style.display = 'none';
          confirmBtn.textContent = 'Confirm';
          confirmBtn.classList.remove('confirmed');
          confirmBtn.disabled = false;
          
          // Disable analysis cards if URL is cleared
          if (!this.value.trim()) {
            analysisCards.forEach(card => {
              card.classList.add('disabled');
            });
            
            analysisLinks.forEach(link => {
              link.classList.add('disabled');
            });
          }
        });
        
        // Keyboard shortcut: Enter to confirm
        urlInput.addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
            confirmBtn.click();
          }
        });
        
        // Initialize with YouTube placeholder
        updatePlaceholder('youtube');
        
        // Add click handler for analysis cards (for visual feedback)
        analysisCards.forEach(card => {
          card.addEventListener('click', function(e) {
            // Only trigger if not disabled and not clicking on the link itself
            if (!this.classList.contains('disabled') && e.target !== this.querySelector('.analysis-link')) {
              const link = this.querySelector('.analysis-link');
              if (link && !link.classList.contains('disabled')) {
                // Add visual feedback before navigation
                this.style.transform = 'scale(0.98)';
                setTimeout(() => {
                  this.style.transform = '';
                }, 200);
              }
            }
          });
        });
      });
    </script>
  </body>
</html>