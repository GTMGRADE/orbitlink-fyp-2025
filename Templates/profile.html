<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Personal Profile - OrbitLink</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: Arial, sans-serif;
        background-color: #1E3167;
        color: white;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      /* Navigation Bar */
      .navbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1.2rem 3%;
        background-color: #1E3167;
        flex-shrink: 0;
      }

      .logo {
        font-size: 2rem;
        font-weight: bold;
        color: white;
        text-decoration: none;
      }

      .nav-links {
        display: flex;
        gap: 1rem;
      }

      .nav-links a {
        text-decoration: none;
        color: rgb(0, 0, 0);
        font-weight: 600;
        padding: 0.7rem 1.5rem;
        border-radius: 6px;
        transition: all 0.3s;
        background-color: #ff3333;
      }

      .nav-links a:hover {
        background-color: #cc0000;
        transform: translateY(-3px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      }

      /* Main Content - Compact Side-by-Side Layout */
      .main-container {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        padding: 2rem 3% 4rem 3%;
      }

      .profile-wrapper {
        width: 100%;
        max-width: 1000px;
        background-color: #0f1c3d;
        border-radius: 20px;
        overflow: hidden;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        display: flex;
        min-height: 500px;
      }

      /* Left Column - Account Management */
      .left-column {
        flex: 1;
        padding: 2.5rem;
        background: rgba(255, 255, 255, 0.05);
        display: flex;
        flex-direction: column;
      }

      .section-title {
        font-size: 1.4rem;
        color: white;
        margin-bottom: 1.5rem;
        font-weight: 600;
        position: relative;
        padding-bottom: 0.8rem;
      }

      .section-title::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 50px;
        height: 3px;
        background: #F24822;
        border-radius: 2px;
      }

      /* Account Management Buttons */
      .management-buttons {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        flex-grow: 1;
      }

      .management-btn {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1.2rem;
        background: rgba(255, 255, 255, 0.07);
        border-radius: 10px;
        border: 1px solid rgba(255, 255, 255, 0.12);
        transition: all 0.3s ease;
        text-decoration: none;
        color: white;
      }

      .management-btn:hover {
        background: rgba(255, 255, 255, 0.12);
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        border-color: rgba(255, 255, 255, 0.25);
      }

      .btn-icon {
        width: 40px;
        height: 40px;
        background: linear-gradient(135deg, #ff3333 0%, #cc0000 100%);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.1rem;
        flex-shrink: 0;
      }

      .btn-content {
        flex-grow: 1;
      }

      .btn-content h3 {
        font-size: 1rem;
        font-weight: 700;
        margin-bottom: 0.3rem;
      }

      .btn-content p {
        font-size: 0.85rem;
        color: rgba(255, 255, 255, 0.7);
      }

      .btn-arrow {
        color: rgba(255, 255, 255, 0.5);
        font-size: 1rem;
      }

      /* Right Column - Profile Info */
      .right-column {
        flex: 1;
        padding: 2.5rem;
        background: linear-gradient(135deg, #1a3a52 0%, #14294a 100%);
        display: flex;
        flex-direction: column;
        position: relative;
      }

      /* Profile Header */
      .profile-header {
        margin-bottom: 2rem;
      }

      .profile-header h1 {
        font-size: 1.8rem;
        font-weight: bold;
        color: white;
        margin-bottom: 0.5rem;
        letter-spacing: 0.5px;
      }

      .profile-header p {
        font-size: 1rem;
        color: rgba(255, 255, 255, 0.8);
        line-height: 1.5;
      }

      /* User Info */
      .user-info {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        flex-grow: 1;
        padding: 1rem 0;
      }

      .avatar {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: #fff;
        font-size: 2.5rem;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        border: 4px solid #F24822;
        margin-bottom: 1.5rem;
      }

      .username {
        font-size: 1.6rem;
        font-weight: 800;
        color: white;
        margin-bottom: 0.8rem;
        text-align: center;
      }

      .user-type {
        display: inline-block;
        padding: 0.5rem 1.5rem;
        background: rgba(242, 72, 34, 0.2);
        color: #F24822;
        border-radius: 20px;
        font-weight: 700;
        font-size: 0.9rem;
        letter-spacing: 0.5px;
        border: 1px solid rgba(242, 72, 34, 0.4);
      }

      /* Success Message */
      .message {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        color: white;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1.5rem;
        font-weight: 600;
        font-size: 0.95rem;
        border-left: 4px solid #047857;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .message::before {
        content: "âœ“";
        font-size: 1rem;
        font-weight: bold;
        background: rgba(255, 255, 255, 0.2);
        width: 25px;
        height: 25px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
      }

      /* Delete Account Button - Updated to remove danger zone title */
      .delete-account-section {
        margin-top: auto;
        padding-top: 1.5rem;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
      }

      .delete-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        width: 100%;
        padding: 0.9rem;
        background: linear-gradient(135deg, #ff3333 0%, #cc0000 100%);
        color: white;
        text-decoration: none;
        border-radius: 8px;
        font-weight: 700;
        font-size: 0.95rem;
        transition: all 0.3s;
        border: none;
        cursor: pointer;
      }

      .delete-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(255, 51, 51, 0.3);
      }

      /* Footer */
      footer {
        padding: 1.5rem 3%;
        background-color: #1e1e1e;
        text-align: center;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        flex-shrink: 0;
        width: 100%;
      }

      footer p {
        color: rgba(255, 255, 255, 0.7);
        margin: 0.5rem 0;
        font-size: 1rem;
      }

      /* Responsive Design */
      @media (max-width: 900px) {
        .profile-wrapper {
          flex-direction: column;
          max-width: 600px;
        }
        
        .left-column, .right-column {
          padding: 2rem;
        }
        
        .right-column {
          padding-top: 3rem;
          min-height: 350px;
        }
      }

      @media (max-width: 768px) {
        .navbar {
          padding: 1rem 5%;
        }
        
        .logo {
          font-size: 1.8rem;
        }
        
        .nav-links {
          gap: 0.5rem;
        }
        
        .nav-links a {
          padding: 0.5rem 1rem;
          font-size: 0.9rem;
        }
        
        .main-container {
          padding: 1.5rem 5% 3rem 5%;
        }
        
        .profile-wrapper {
          border-radius: 15px;
        }
      }

      @media (max-width: 480px) {
        .left-column, .right-column {
          padding: 1.5rem;
        }
        
        .section-title {
          font-size: 1.2rem;
        }
        
        .management-btn {
          padding: 1rem;
        }
        
        .btn-icon {
          width: 35px;
          height: 35px;
          font-size: 1rem;
        }
        
        .avatar {
          width: 80px;
          height: 80px;
          font-size: 2rem;
        }
        
        .username {
          font-size: 1.4rem;
        }
        
        .profile-header h1 {
          font-size: 1.5rem;
        }
        
        footer {
          padding: 1.2rem 5%;
        }
      }
    </style>
  </head>
  <body>
    <!-- Navigation Bar -->
    <nav class="navbar">
      <a href="{{ url_for('projects.dashboard') }}" class="logo">OrbitLink</a>
      <div class="nav-links">
        <a href="{{ url_for('projects.dashboard') }}">Home</a>
      </div>
    </nav>

    <!-- Main Content -->
    <div class="main-container">
      <div class="profile-wrapper">
        <!-- Left Column - Account Management -->
        <div class="left-column">
          <h2 class="section-title">Account Management</h2>
          
          {% if message %}
          <div class="message">{{ message }}</div>
          {% endif %}
          
          <div class="management-buttons">
            <a href="{{ url_for('user.change_username_get') }}" class="management-btn">
              <div class="btn-icon">
                <i class="fas fa-user-edit"></i>
              </div>
              <div class="btn-content">
                <h3>Change Username</h3>
                <p>Update your display name</p>
              </div>
              <div class="btn-arrow">
                <i class="fas fa-chevron-right"></i>
              </div>
            </a>
            
            <a href="{{ url_for('user.change_password_get') }}" class="management-btn">
              <div class="btn-icon">
                <i class="fas fa-key"></i>
              </div>
              <div class="btn-content">
                <h3>Change Password</h3>
                <p>Update your security password</p>
              </div>
              <div class="btn-arrow">
                <i class="fas fa-chevron-right"></i>
              </div>
            </a>
            
            <a href="{{ url_for('user.reset_password_get') }}" class="management-btn">
              <div class="btn-icon">
                <i class="fas fa-redo"></i>
              </div>
              <div class="btn-content">
                <h3>Reset Password</h3>
                <p>Reset your password via email</p>
              </div>
              <div class="btn-arrow">
                <i class="fas fa-chevron-right"></i>
              </div>
            </a>
            
            <a href="{{ url_for('user.logout') }}" class="management-btn">
              <div class="btn-icon">
                <i class="fas fa-sign-out-alt"></i>
              </div>
              <div class="btn-content">
                <h3>Logout</h3>
                <p>Sign out of your account</p>
              </div>
              <div class="btn-arrow">
                <i class="fas fa-chevron-right"></i>
              </div>
            </a>
          </div>
        </div>

        <!-- Right Column - Profile Info -->
        <div class="right-column">
          <div class="profile-header">
            <h1>Personal Profile</h1>
            <p>Manage your account settings and preferences</p>
          </div>
          
          <div class="user-info">
            <div class="avatar">ðŸ‘¤</div>
            <div class="username">{{ user.username | upper }}</div>
            <div class="user-type">
              <!-- Type: {{ user_type|default('business')|capitalize }} -->
              Registered User
            </div>
          </div>
          
          <!-- REMOVED: Danger Zone title, kept only the Delete Account button -->
          <div class="delete-account-section">
            <button class="delete-btn" onclick="showDeleteModal(); return false;">
              <i class="fas fa-trash"></i>
              Delete Account
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Delete Account Modal -->
    <div id="deleteModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); z-index: 10000; align-items: center; justify-content: center;">
      <div style="background: #1e3a52; padding: 2.5rem; border-radius: 16px; max-width: 500px; width: 90%; border: 2px solid rgba(255, 51, 51, 0.5); box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);">
        <h2 style="color: #ff3333; margin-bottom: 1.5rem; font-size: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
          <i class="fas fa-exclamation-triangle"></i>
          Delete Account
        </h2>
        
        <p style="color: rgba(255, 255, 255, 0.9); margin-bottom: 1.5rem; line-height: 1.6;">
          Are you sure you want to delete your account? This action <strong>cannot be undone</strong>.
        </p>
        
        {% if user_has_reviews %}
        <div style="background: rgba(255, 255, 255, 0.05); padding: 1.2rem; border-radius: 12px; margin-bottom: 1.5rem; border-left: 3px solid #ffa500;">
          <p style="color: rgba(255, 255, 255, 0.85); font-size: 0.95rem; margin-bottom: 1rem;">
            <strong>What happens to your reviews?</strong>
          </p>
          
          <label style="display: flex; align-items: flex-start; gap: 0.8rem; cursor: pointer; color: rgba(255, 255, 255, 0.9);">
            <input type="checkbox" id="deleteReviewsCheckbox" style="margin-top: 0.2rem; width: 18px; height: 18px; cursor: pointer;">
            <span style="font-size: 0.9rem; line-height: 1.5;">
              Also delete my reviews<br>
              <small style="color: rgba(255, 255, 255, 0.6);">
                If unchecked, your reviews will remain visible but shown as "Anonymous User"
              </small>
            </span>
          </label>
        </div>
        {% endif %}
        
        <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
          <button onclick="hideDeleteModal()" style="flex: 1; padding: 0.8rem; border: 2px solid rgba(255, 255, 255, 0.3); background: transparent; color: white; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='rgba(255, 255, 255, 0.1)'" onmouseout="this.style.background='transparent'">
            Cancel
          </button>
          <button onclick="confirmDelete()" style="flex: 1; padding: 0.8rem; background: #ff3333; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='#cc0000'" onmouseout="this.style.background='#ff3333'">
            <i class="fas fa-trash"></i> Delete Account
          </button>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer>
      <p>Â© 2024 OrbitLink Analytics Platform. All rights reserved.</p>
      <p>Contact: support@orbitlink.com</p>
    </footer>

    <script>
      function showDeleteModal() {
        const modal = document.getElementById('deleteModal');
        modal.style.display = 'flex';
      }
      
      function hideDeleteModal() {
        const modal = document.getElementById('deleteModal');
        modal.style.display = 'none';
      }
      
      function confirmDelete() {
        const checkbox = document.getElementById('deleteReviewsCheckbox');
        const deleteReviews = checkbox ? checkbox.checked : false;
        
        // Create a hidden form to submit the delete request
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = '{{ url_for("user.delete_account") }}';
        
        // Add hidden input for delete_reviews option
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = 'delete_reviews';
        input.value = deleteReviews ? 'true' : 'false';
        form.appendChild(input);
        
        document.body.appendChild(form);
        form.submit();
        return false;
      }
      
      // Close modal on escape key
      document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
          hideDeleteModal();
        }
      });
      
      // Close modal on background click
      document.getElementById('deleteModal')?.addEventListener('click', function(event) {
        if (event.target === this) {
          hideDeleteModal();
        }
      });

      // Add subtle hover animations
      document.querySelectorAll('.management-btn').forEach(btn => {
        btn.addEventListener('mouseenter', function() {
          const icon = this.querySelector('.btn-icon');
          icon.style.transform = 'scale(1.1) rotate(5deg)';
          icon.style.transition = 'transform 0.3s ease';
        });
        
        btn.addEventListener('mouseleave', function() {
          const icon = this.querySelector('.btn-icon');
          icon.style.transform = 'scale(1) rotate(0deg)';
        });
      });

      // Remove any pulsing animations from user type badge
      const userTypeBadge = document.querySelector('.user-type');
      if (userTypeBadge) {
        userTypeBadge.style.transition = 'all 0.3s ease';
      }
    </script>
  </body>
</html>